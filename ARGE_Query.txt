Resources
| where type == "microsoft.network/publicipaddresses"
| extend ipAssigned = isempty(properties.ipConfiguration.id)
| where ipAssigned == true
| project
    name,
    type,
    id,
    subscriptionId,
    resourceGroup,
    location,
    tags,
    sku,
    zones,
    properties.*


Resources
| where type == "microsoft.keyvault/vaults"
| extend
    vaultName = name,
    networkAcls = properties.networkAcls,
    defaultAction = tostring(properties.networkAcls.defaultAction),
    bypass = tostring(properties.networkAcls.bypass)
| where defaultAction == "Allow"
| project subscriptionId, resourceGroup, vaultName, location, defaultAction, bypass


Resources
| where type == "microsoft.keyvault/vaults"
| extend
    vaultName = name,
    privateEndpoints = properties.privateEndpointConnections
| where isempty(privateEndpoints)
| project subscriptionId, resourceGroup, vaultName, location

